(this.webpackJsonppore=this.webpackJsonppore||[]).push([[0],{167:function(e,t){},197:function(e,t,a){e.exports=a(343)},202:function(e,t,a){},203:function(e,t,a){},334:function(e,t){},335:function(e,t){},343:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),r=a(23),o=a.n(r),c=(a(202),a(203),a(83)),m=a(353),s=a(354),i=a(355),d=a(357),u=(a(66),a(356)),p=(a(130),a(41)),E=a(56),f=a.n(E);var h=function(){let[e,t]=n.a.useState(null),[a,l]=n.a.useState([]),[r,o]=n.a.useState(!1),[E,h]=n.a.useState(1),[b,g]=n.a.useState(1),[y,D]=n.a.useState(!1),[w,v]=n.a.useState([]),[k,O]=n.a.useState("webe");const P={webe:{poNumber:/PO\s+Number\s+:\s*(?<ponumber>\d+)/,poDate:/PO\s+Date\s+:\s*(?<podate>[\d]+[\.|\-|\\][\d]+[\.|\-|\\][\d]+)/,poSite:/SITE ID\s*.\s*(?<poSite>\w+)/i,poContract:/Contract\s+No\s+:\s(?<contractno>\d+)/,items:/(?<item>\d{1,2})\s(?<materialno>\d{10})\s(?<description>.+?)\s(?<date>\d{1,2}\.\d{1,2}\.\d{4})\s(?<quantity>\d+|\d+.\d+)\s(?<quantifier>\w+)\s(?<unitprice>\d+\,?\d*\.\d{2})\s(?<totalprice>\d*\,?\d+\.\d{2})/gm},ericssondigi:{poNumber:/Purchase Order\s*(?<ponumber>\d{10})/,poDate:/Date\s*(?<podate>\d{2}\.\d{2}\.\d{4})\s*\(DD\.MM\.YYYY\)/,items:/\s(?<itemno>\d{5})\s+(?<description>.{1,50})\s+(?<quantity>\d+\.{0,1}\d{0,})\s+(?<unit>\w+)\s+(?<unitprice>\d+(\,\d{3}){0,}\.\d{2})\s+(?<linevalue>\d+(\,\d{3}){0,}\.\d{2})(.+?)(?<siteid>\d{4}[a-z|A-Z](\_\d){0,1})/gm},ericssondnb:{poNumber:/Purchase Order\s*(?<ponumber>\d{10})/,poDate:/Date\s*(?<podate>\d{2}\.\d{2}\.\d{4})\s*\(DD\.MM\.YYYY\)/,items:/\s(?<itemno>\d{5})\s+(?<description>.{1,50})\s+(?<quantity>\d+\.{0,1}\d{0,})\s+(?<unit>\w+)\s+(?<unitprice>\d+(\,\d{3}){0,}\.\d{2})\s+(?<linevalue>\d+(\,\d{3}){0,}\.\d{2})?(?<description2>.+?)(?<siteid>[A-Z|a-z]{5}\d{4})/gm}};let x=n.a.createRef(),N=()=>{let e=[],t=w.flatMap(e=>e.items);if(e=t.map(e=>Object.values(e)),e.length>0){let a=new f.a.Workbook,l=a.addWorksheet("PO");l.addRow(Object.keys(t[0])),console.log(Object.keys(t[0])),console.log(e),Object.keys(t[0]).forEach((t,a)=>{t.match(/date/g)&&(console.log(`Convert column ${a+1} to date format`),l.getColumn(""+(e=>{for(var t="",a=1,l=26;(e-=a)>=0;a=l,l*=26)t=String.fromCharCode(parseInt(e%l/a)+65)+t;return t})(a+1)).numFmt="d-mmm-yy",e.forEach(e=>{e[a]=p.utc(e[a],"YYYY/MM/DD").toDate()}))}),l.addRows(e),a.xlsx.writeBuffer().then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download="PO_Export.xlsx",a.click()})}},S=async e=>{let t=Array.from(e).map(e=>new Promise(t=>{let a=new FileReader;a.onload=l=>{let n=window.pdf2text(btoa(a.result));console.log(n);let[r,o,c]=["","",""];P[k].poNumber&&n.match(P[k].poNumber)&&(r=n.match(P[k].poNumber).groups.ponumber),P[k].poDate&&n.match(P[k].poDate)&&(o=p(n.match(P[k].poDate).groups.podate,"DD.MM.YYYY").format("YYYY/MM/DD")),P[k].poSite&&n.match(P[k].poSite)&&(c=n.match(P[k].poSite).groups.poSite);let m=n.matchAll(P[k].items),s=Array.from(m).map(e=>e.groups).map(e=>({posite:c,ponumber:r,podate:o,...e}));if(s.forEach(e=>{"date"in e&&(e.date=p(e.date,"DD.MM.YYYY").format("YYYY/MM/DD"))}),P[k].poContract&&(console.log(n.match(P[k].poContract)),n.match(P[k].poContract))){"3400033518"===n.match(P[k].poContract).groups.contractno&&s.forEach(e=>{"materialno"in e&&(e.materialno="T"+e.materialno)})}t({poDate:o,poNumber:r,items:s||[],data:btoa(a.result),filename:e.name})},a.readAsBinaryString(e)}));Promise.all(t).then(e=>{v(e),console.log(e)})};const C=.8*window.innerWidth;return n.a.createElement(n.a.Fragment,null,n.a.createElement(u.a,{style:{marginBottom:"10px"}},n.a.createElement(u.a.Select,{label:"Select PO type",options:[{key:"webe",value:"webe",text:"Webe PO"},{key:"ericssondigi",value:"ericssondigi",text:"Ericsson Digi PO"},{key:"ericssondnb",value:"ericssondnb",text:"Ericsson DNB PO"}],value:k,onChange:(e,t)=>{let{value:a}=t;return O(a)}})),n.a.createElement("div",{className:"dropFileArea",onDragOver:e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:e=>{e.stopPropagation(),e.preventDefault();let t=e.dataTransfer.files;S(t)}},n.a.createElement("div",{style:{display:"flex",height:"40px",verticalAlign:"middle"}},n.a.createElement("div",{style:{padding:"8px"}},"Drop multiple PO PDF files or"),n.a.createElement(m.a,{onClick:()=>{x.current.click()}},"Select Files"),n.a.createElement("input",{type:"file",ref:x,onChange:e=>{let t=e.target.files;t.length>0&&S(t)},style:{display:"none"},accept:".pdf",multiple:!0}))),n.a.createElement("div",{className:"actionArea"},w.length>0&&n.a.createElement(m.a,{variant:"secondary",onClick:()=>{N()}},"Export to Excel")),n.a.createElement("div",{className:"itemsArea"},w.length>0&&n.a.createElement(s.a,{size:"sm",hover:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("td",null,"Filename"),n.a.createElement("td",null,"PO Number"),n.a.createElement("td",null,"PO Date"),n.a.createElement("td",null,"Number of items"),n.a.createElement("td",null))),n.a.createElement("tbody",null,w.map((e,a)=>n.a.createElement("tr",{key:a},n.a.createElement("td",null,e.filename),n.a.createElement("td",null,e.poNumber),n.a.createElement("td",null,e.poDate),n.a.createElement("td",null,e.items.length),n.a.createElement("td",null,n.a.createElement(i.a,{size:"sm"},n.a.createElement(m.a,{onClick:()=>{t(e.data),g(1),D(!0)}},"View PDF"),n.a.createElement(m.a,{onClick:()=>{l(e.items),o(!0)}},"View Item")))))))),n.a.createElement(d.a,{centered:!0,scrollable:!0,show:y,onHide:()=>{D(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(d.a.Header,{closeButton:!0},n.a.createElement(d.a.Title,null,"PDF Document")),n.a.createElement(d.a.Body,null,null!==e&&n.a.createElement(c.PDFReader,{data:atob(e),size:.7,onDocumentComplete:e=>{h(e)},page:b,width:C})),n.a.createElement(d.a.Footer,null,n.a.createElement("div",null,"Page ",b," of ",E),n.a.createElement(m.a,{variant:"secondary",onClick:()=>{b-1>=0&&g(b-1)},disabled:1==b},"Previous"),n.a.createElement(m.a,{variant:"secondary",onClick:()=>{b+1<=E&&g(b+1)},disabled:b==E},"Next"))),n.a.createElement(d.a,{centered:!0,scrollable:!0,show:r,onHide:()=>{o(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(d.a.Header,{closeButton:!0},n.a.createElement(d.a.Title,null,"Items")),n.a.createElement(d.a.Body,null,a.length>0&&n.a.createElement("table",{className:"po-output"},n.a.createElement("thead",null,n.a.createElement("tr",null,Object.keys(a[0]).map((e,t)=>n.a.createElement("td",{key:t},e+"\t")))),n.a.createElement("tbody",null,a.map((e,t)=>n.a.createElement("tr",{key:"item_"+t},Object.keys(e).map((a,l)=>n.a.createElement("td",{key:`item_${t}_${l}`},e[a]+"\t")))),n.a.createElement("tr",null))))))};var b=function(){let[e,t]=n.a.useState(null),[a,l]=n.a.useState([]),[r,o]=n.a.useState(!1),[u,E]=n.a.useState(1),[h,b]=n.a.useState(1),[g,y]=n.a.useState(!1),[D,w]=n.a.useState([]),v=n.a.createRef(),k=async e=>{let t=Array.from(e).map(e=>new Promise(t=>{let a=new FileReader;a.onload=async l=>{var n=window.pdfjsLib.getDocument({data:a.result}),r=await n.promise.then(async e=>{const t=e.numPages;let a="";for(let l=1;l<=t;l++){a+=" "+await e.getPage(l).then(async e=>e.getTextContent().then(async e=>{for(var t=e.items,a="",l=0;l<t.length;l++){a+=t[l].str+" "}return a}))}return a});console.log(r);let o="",c="",m="";r.match(/PO\s+No\.\s+:\s*(?<ponumber>\d+)/i)&&(o=r.match(/PO\s+No\.\s+:\s*(?<ponumber>\d+)/i).groups.ponumber),r.match(/No\.?\s+:\s+(?<donumber>\w{15})\s+Date\s+:\s*(?<dodate>\d{1,2}\-\w{3}\-\d{4})/i)&&(c=p(r.match(/No\.?\s+:\s+(?<donumber>\w{15})\s+Date\s+:\s*(?<dodate>\d{1,2}\-\w{3}\-\d{4})/i).groups.dodate,"DD-MMM-YYYY").format("YYYY/MM/DD"),m=r.match(/No\.?\s+:\s+(?<donumber>\w{15})\s+Date\s+:\s*(?<dodate>\d{1,2}\-\w{3}\-\d{4})/i).groups.donumber);let s=r.matchAll(/(?<noitem>\d{1,2})\s+(?<quantity>\d+|\d+.\d+)\s+(?<materialno>\d{10})\s+(?<sitecode>\w{6})\s+(?<UOM>\w+)\s+(?<description>.+?((?=(\s+(\d{1,2})\s+(\d+|\d+.\d+)))|(?=\s+OCK Setia)|(?=\s+RECEIVED)))/gim),i=Array.from(s).map(e=>e.groups).map(e=>({ponumber:o,dodate:c,donumber:m,...e}));t({doDate:c,doNumber:m,poNumber:o,items:i||[],data:btoa(a.result),filename:e.name})},a.readAsBinaryString(e)}));Promise.all(t).then(e=>{w(e),console.log(e)})};const O=.8*window.innerWidth;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"dropFileArea",onDragOver:e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:e=>{e.stopPropagation(),e.preventDefault();let t=e.dataTransfer.files;k(t)}},n.a.createElement("div",{style:{display:"flex",height:"40px",verticalAlign:"middle"}},n.a.createElement("div",{style:{padding:"8px"}},"Drop multiple DO PDF files or"),n.a.createElement(m.a,{onClick:()=>{v.current.click()}},"Select Files"),n.a.createElement("input",{type:"file",ref:v,onChange:e=>{let t=e.target.files;t.length>0&&k(t)},style:{display:"none"},accept:".pdf",multiple:!0}))),n.a.createElement("div",{className:"actionArea"},D.length>0&&n.a.createElement(m.a,{variant:"secondary",onClick:()=>{(()=>{let e=[],t=D.flatMap(e=>e.items);if(e=t.map(e=>Object.values(e)),e.length>0){let a=new f.a.Workbook,l=a.addWorksheet("PO");l.addRow(Object.keys(t[0])),l.addRows(e),a.xlsx.writeBuffer().then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download="DO_Export.xlsx",a.click()})}})()}},"Export to Excel")),n.a.createElement("div",{className:"itemsArea"},D.length>0&&n.a.createElement(s.a,{size:"sm",hover:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("td",null,"Filename"),n.a.createElement("td",null,"DO Number"),n.a.createElement("td",null,"DO Date"),n.a.createElement("td",null,"PO Number"),n.a.createElement("td",null,"Number of items"),n.a.createElement("td",null))),n.a.createElement("tbody",null,D.map((e,a)=>n.a.createElement("tr",{key:a},n.a.createElement("td",null,e.filename),n.a.createElement("td",null,e.doNumber),n.a.createElement("td",null,e.doDate),n.a.createElement("td",null,e.poNumber),n.a.createElement("td",null,e.items.length),n.a.createElement("td",null,n.a.createElement(i.a,{size:"sm"},n.a.createElement(m.a,{onClick:()=>{t(e.data),b(1),y(!0)}},"View PDF"),n.a.createElement(m.a,{onClick:()=>{l(e.items),o(!0)}},"View Item")))))))),n.a.createElement(d.a,{centered:!0,scrollable:!0,show:g,onHide:()=>{y(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(d.a.Header,{closeButton:!0},n.a.createElement(d.a.Title,null,"PDF Document")),n.a.createElement(d.a.Body,null,null!==e&&n.a.createElement(c.PDFReader,{data:atob(e),size:.7,onDocumentComplete:e=>{E(e)},page:h,width:O})),n.a.createElement(d.a.Footer,null,n.a.createElement("div",null,"Page ",h," of ",u),n.a.createElement(m.a,{variant:"secondary",onClick:()=>{h-1>=0&&b(h-1)},disabled:1==h},"Previous"),n.a.createElement(m.a,{variant:"secondary",onClick:()=>{h+1<=u&&b(h+1)},disabled:h==u},"Next"))),n.a.createElement(d.a,{centered:!0,scrollable:!0,show:r,onHide:()=>{o(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(d.a.Header,{closeButton:!0},n.a.createElement(d.a.Title,null,"Items")),n.a.createElement(d.a.Body,null,a.length>0&&n.a.createElement("table",{className:"po-output"},n.a.createElement("thead",null,n.a.createElement("tr",null,Object.keys(a[0]).map((e,t)=>n.a.createElement("td",{key:t},e+"\t")))),n.a.createElement("tbody",null,a.map((e,t)=>n.a.createElement("tr",{key:"item_"+t},Object.keys(e).map((a,l)=>n.a.createElement("td",{key:`item_${t}_${l}`},e[a]+"\t")))),n.a.createElement("tr",null))))))},g=a(122),y=a.n(g);var D=function(e){const t=n.a.useRef(null),[a,l]=n.a.useState([]);let[r,o]=n.a.useState([]),[c,u]=n.a.useState(!1),E=async e=>{let t=Array.from(e).map(e=>new Promise(t=>{let a=new FileReader;a.onload=a=>{var l,n;const r=a.target.result;let o=y.a.read(r,{type:"binary"}),c=o.Sheets[o.SheetNames[0]],m=y.a.utils.sheet_to_json(c);console.log(m);const s={"PO No.":"","Submission Date":""},i=["Line","Project Area","Site ID","Site Name","Item Num","Description","Remark","Unit","Qty","Unit Price","Amount"];let d=null,u=null,p=[];m.forEach(e=>{if(Object.entries(e).forEach(e=>{let[t,a]=e;a in s?""===s[a]&&(d=a):null!==d&&(s[d]=a,d=null)}),Object.entries(e).every(e=>{let[t,a]=e;return i.includes(a)}))u=e;else if(null!==u)if(Object.values(e).length<5)u=null;else{let t=Object.entries(u).reduce((t,a)=>{let[l,n]=a;return l in e&&(t[n]=e[l]),t},{});p.push(t)}}),p.forEach(e=>{Object.entries(s).forEach(t=>{let[a,l]=t;e[a]=l})});let E={poDate:null!==(l=null!==(n=s.Date)&&void 0!==n?n:s["Submission Date"])&&void 0!==l?l:"",poNumber:s["Purchase Contract"],items:p||[],filename:e.name};t(E)},a.readAsBinaryString(e)}));Promise.all(t).then(e=>{console.log(e),l(e)})},h=()=>{let e=[],t=a.flatMap(e=>e.items);if(e=t.map(e=>Object.values(e)),e.length>0){let a=new f.a.Workbook,l=a.addWorksheet("PO");l.addRow(Object.keys(t[0])),console.log(Object.keys(t[0])),console.log(e),Object.keys(t[0]).forEach((t,a)=>{t.match(/date/gi)&&(console.log(`Convert column ${a+1} to date format`),l.getColumn(""+(e=>{for(var t="",a=1,l=26;(e-=a)>=0;a=l,l*=26)t=String.fromCharCode(parseInt(e%l/a)+65)+t;return t})(a+1)).numFmt="d-mmm-yy",e.forEach(e=>{e[a]=p.utc(e[a],"YYYY/MM/DD").toDate()}))}),l.addRows(e),a.xlsx.writeBuffer().then(e=>{let t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download="PO_Export.xlsx",a.click()})}};return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"dropFileArea",onDragOver:e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:e=>{e.stopPropagation(),e.preventDefault();let t=e.dataTransfer.files;E(t)}},n.a.createElement("div",{style:{display:"flex",height:"40px",verticalAlign:"middle"}},n.a.createElement("div",{style:{padding:"8px"}},"Drop multiple PO Excels files or"),n.a.createElement(m.a,{onClick:()=>{t.current.click()}},"Select Files"),n.a.createElement("input",{type:"file",ref:t,onChange:e=>{let t=e.target.files;t.length>0&&E(t)},style:{display:"none"},accept:".xlsx, .xls",multiple:!0}))),n.a.createElement("div",{className:"actionArea"},a.length>0&&n.a.createElement(m.a,{variant:"secondary",onClick:()=>{h()}},"Export to Excel")),n.a.createElement("div",{className:"itemsArea"},a.length>0&&n.a.createElement(s.a,{size:"sm",hover:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("td",null,"Filename"),n.a.createElement("td",null,"PO Number"),n.a.createElement("td",null,"PO Date"),n.a.createElement("td",null,"Number of items"),n.a.createElement("td",null))),n.a.createElement("tbody",null,a.map((e,t)=>n.a.createElement("tr",{key:t},n.a.createElement("td",null,e.filename),n.a.createElement("td",null,e.poNumber),n.a.createElement("td",null,e.poDate),n.a.createElement("td",null,e.items.length),n.a.createElement("td",null,n.a.createElement(i.a,{size:"sm"},n.a.createElement(m.a,{onClick:()=>{o(e.items),u(!0)}},"View Item")))))))),n.a.createElement(d.a,{centered:!0,scrollable:!0,show:c,onHide:()=>{u(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(d.a.Header,{closeButton:!0},n.a.createElement(d.a.Title,null,"Items")),n.a.createElement(d.a.Body,null,r.length>0&&n.a.createElement("table",{className:"po-output"},n.a.createElement("thead",null,n.a.createElement("tr",null,Object.keys(r[0]).map((e,t)=>n.a.createElement("td",{key:t},e+"\t")))),n.a.createElement("tbody",null,r.map((e,t)=>n.a.createElement("tr",{key:"item_"+t},Object.keys(e).map((a,l)=>{var r;return n.a.createElement("td",{key:`item_${t}_${l}`},(null!==(r=e[a])&&void 0!==r?r:"")+"\t")}))),n.a.createElement("tr",null))))))},w=a(359),v=a(358),k=a(65),O=a(17);var P=function(e){return n.a.createElement(k.a,{basename:"poer"},n.a.createElement(w.a,{bg:"dark",variant:"dark"},n.a.createElement(w.a.Brand,null,"PDF Extract"),n.a.createElement(v.a,{className:"mr-auto"},n.a.createElement(v.a.Link,{as:k.b,to:"po",activeStyle:{color:"white"}},"Purchase Order (PDF)"),n.a.createElement(v.a.Link,{as:k.b,to:"do",activeStyle:{color:"white"}},"Delivery Order"),n.a.createElement(v.a.Link,{as:k.b,to:"excelpo",activeStyle:{color:"white"}},"Purchase Order (Excel)"))),n.a.createElement("div",{className:"App"},n.a.createElement(O.d,null,n.a.createElement(O.b,{path:"/po"},n.a.createElement(h,null)),n.a.createElement(O.b,{path:"/do"},n.a.createElement(b,null)),n.a.createElement(O.b,{path:"/excelpo"},n.a.createElement(D,null)),n.a.createElement(O.b,{path:"/"},n.a.createElement(O.a,{to:{pathname:"po"}})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})}},[[197,1,2]]]);
//# sourceMappingURL=main.f5f85195.chunk.js.map