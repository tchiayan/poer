(this.webpackJsonppore=this.webpackJsonppore||[]).push([[0],{174:function(e,t){},207:function(e,t,a){e.exports=a(345)},212:function(e,t,a){},213:function(e,t,a){},340:function(e,t){},341:function(e,t){},345:function(e,t,a){"use strict";a.r(t);var u=a(0),n=a.n(u),r=a(23),l=a.n(r),c=(a(212),a(213),a(25)),o=a.n(c),i=a(94),m=a(21),s=a(17),F=a(95),d=a(355),E=a(356),p=a(357),f=a(359),A=(a(76),a(358)),b=(a(141),a(44)),x=a(64),h=a.n(x);var v=function(){var e=n.a.useState(null),t=Object(s.a)(e,2),a=t[0],u=t[1],r=n.a.useState([]),l=Object(s.a)(r,2),c=l[0],x=l[1],v=n.a.useState(!1),g=Object(s.a)(v,2),y=g[0],O=g[1],D=n.a.useState(1),w=Object(s.a)(D,2),k=w[0],j=w[1],P=n.a.useState(1),N=Object(s.a)(P,2),C=N[0],S=N[1],Y=n.a.useState(!1),z=Object(s.a)(Y,2),_=z[0],M=z[1],B=n.a.useState([]),R=Object(s.a)(B,2),I=R[0],T=R[1],Z=n.a.useState("webe"),L=Object(s.a)(Z,2),W=L[0],H=L[1],U={webe:{poNumber:Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Number[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+)/,{ponumber:1}),poDate:Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+[\x2D\.\\\|][0-9]+[\x2D\.\\\|][0-9]+)/,{podate:1}),poSite:Object(m.a)(/SITE ID[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*.[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9A-Z_a-z]+)/i,{poSite:1}),poContract:Object(m.a)(/Contract[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+No[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]+)/,{contractno:1}),items:Object(m.a)(/([0-9]{1,2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]{10})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF](.+?)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]{1,2}\.[0-9]{1,2}\.[0-9]{4})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]+|[0-9]+.[0-9]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9A-Z_a-z]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]+,?[0-9]*\.[0-9]{2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]*,?[0-9]+\.[0-9]{2})/gm,{item:1,materialno:2,description:3,date:4,quantity:5,quantifier:6,unitprice:7,totalprice:8})},ericssondigi:{poNumber:Object(m.a)(/Purchase Order[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{10})/,{ponumber:1}),poDate:Object(m.a)(/Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{2}\.[0-9]{2}\.[0-9]{4})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\(DD\.MM\.YYYY\)/,{podate:1}),items:Object(m.a)(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]{5})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+(.{1,50})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+\.?[0-9]*)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+(,[0-9]{3})*\.[0-9]{2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+(,[0-9]{3})*\.[0-9]{2})(.+?)([0-9]{4}[A-Za-z\|](_[0-9])?)/gm,{itemno:1,description:2,quantity:3,unit:4,unitprice:5,linevalue:7,siteid:10})},ericssondnb:{poNumber:Object(m.a)(/Purchase Order[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{10})/,{ponumber:1}),poDate:Object(m.a)(/Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{2}\.[0-9]{2}\.[0-9]{4})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\(DD\.MM\.YYYY\)/,{podate:1}),items:Object(m.a)(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]{5})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+(.{1,50})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+\.?[0-9]*)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+(,[0-9]{3})*\.[0-9]{2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+(,[0-9]{3})*\.[0-9]{2})(.+?)([A-Za-z\|]{5}[0-9]{4})/gm,{itemno:1,description:2,quantity:3,unit:4,unitprice:5,linevalue:7,description2:9,siteid:10})}},V=n.a.createRef(),q=function(){var e=[],t=I.flatMap((function(e){return e.items}));if((e=t.map((function(e){return Object.values(e)}))).length>0){var a=new h.a.Workbook,u=a.addWorksheet("PO");u.addRow(Object.keys(t[0])),console.log(Object.keys(t[0])),console.log(e),Object.keys(t[0]).forEach((function(t,a){t.match(/date/g)&&(console.log("Convert column ".concat(a+1," to date format")),u.getColumn("".concat(function(e){for(var t="",a=1,u=26;(e-=a)>=0;a=u,u*=26)t=String.fromCharCode(parseInt(e%u/a)+65)+t;return t}(a+1))).numFmt="d-mmm-yy",e.forEach((function(e){e[a]=b.utc(e[a],"YYYY/MM/DD").toDate()})))})),u.addRows(e),a.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download="PO_Export.xlsx",a.click()}))}},J=function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=Array.from(e).map((function(e){return new Promise((function(t){var a=new FileReader;a.onload=function(u){var n=window.pdf2text(btoa(a.result));console.log(n);var r="",l="",c="";U[W].poNumber&&n.match(U[W].poNumber)&&(r=n.match(U[W].poNumber).groups.ponumber),U[W].poDate&&n.match(U[W].poDate)&&(l=b(n.match(U[W].poDate).groups.podate,"DD.MM.YYYY").format("YYYY/MM/DD")),U[W].poSite&&n.match(U[W].poSite)&&(c=n.match(U[W].poSite).groups.poSite);var o=n.matchAll(U[W].items),m=Array.from(o).map((function(e){return e.groups})).map((function(e){return Object(i.a)({},{posite:c,ponumber:r,podate:l},{},e)}));(m.forEach((function(e){"date"in e&&(e.date=b(e.date,"DD.MM.YYYY").format("YYYY/MM/DD"))})),U[W].poContract)&&(console.log(n.match(U[W].poContract)),n.match(U[W].poContract)&&"3400033518"===n.match(U[W].poContract).groups.contractno&&m.forEach((function(e){"materialno"in e&&(e.materialno="T".concat(e.materialno))})));t({poDate:l,poNumber:r,items:m||[],data:btoa(a.result),filename:e.name})},a.readAsBinaryString(e)}))})),Promise.all(t).then((function(e){T(e),console.log(e)}));case 2:case"end":return a.stop()}}))},K=.8*window.innerWidth;return n.a.createElement(n.a.Fragment,null,n.a.createElement(A.a,{style:{marginBottom:"10px"}},n.a.createElement(A.a.Select,{label:"Select PO type",options:[{key:"webe",value:"webe",text:"Webe PO"},{key:"ericssondigi",value:"ericssondigi",text:"Ericsson Digi PO"},{key:"ericssondnb",value:"ericssondnb",text:"Ericsson DNB PO"}],value:W,onChange:function(e,t){var a=t.value;return H(a)}})),n.a.createElement("div",{className:"dropFileArea",onDragOver:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;J(t)}},n.a.createElement("div",{style:{display:"flex",height:"40px",verticalAlign:"middle"}},n.a.createElement("div",{style:{padding:"8px"}},"Drop multiple PO PDF files or"),n.a.createElement(d.a,{onClick:function(){V.current.click()}},"Select Files"),n.a.createElement("input",{type:"file",ref:V,onChange:function(e){var t=e.target.files;t.length>0&&J(t)},style:{display:"none"},accept:".pdf",multiple:!0}))),n.a.createElement("div",{className:"actionArea"},I.length>0&&n.a.createElement(d.a,{variant:"secondary",onClick:function(){q()}},"Export to Excel")),n.a.createElement("div",{className:"itemsArea"},I.length>0&&n.a.createElement(E.a,{size:"sm",hover:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("td",null,"Filename"),n.a.createElement("td",null,"PO Number"),n.a.createElement("td",null,"PO Date"),n.a.createElement("td",null,"Number of items"),n.a.createElement("td",null))),n.a.createElement("tbody",null,I.map((function(e,t){return n.a.createElement("tr",{key:t},n.a.createElement("td",null,e.filename),n.a.createElement("td",null,e.poNumber),n.a.createElement("td",null,e.poDate),n.a.createElement("td",null,e.items.length),n.a.createElement("td",null,n.a.createElement(p.a,{size:"sm"},n.a.createElement(d.a,{onClick:function(){u(e.data),S(1),M(!0)}},"View PDF"),n.a.createElement(d.a,{onClick:function(){x(e.items),O(!0)}},"View Item"))))}))))),n.a.createElement(f.a,{centered:!0,scrollable:!0,show:_,onHide:function(){M(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(f.a.Header,{closeButton:!0},n.a.createElement(f.a.Title,null,"PDF Document")),n.a.createElement(f.a.Body,null,null!==a&&n.a.createElement(F.PDFReader,{data:atob(a),size:.7,onDocumentComplete:function(e){j(e)},page:C,width:K})),n.a.createElement(f.a.Footer,null,n.a.createElement("div",null,"Page ",C," of ",k),n.a.createElement(d.a,{variant:"secondary",onClick:function(){C-1>=0&&S(C-1)},disabled:1==C},"Previous"),n.a.createElement(d.a,{variant:"secondary",onClick:function(){C+1<=k&&S(C+1)},disabled:C==k},"Next"))),n.a.createElement(f.a,{centered:!0,scrollable:!0,show:y,onHide:function(){O(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(f.a.Header,{closeButton:!0},n.a.createElement(f.a.Title,null,"Items")),n.a.createElement(f.a.Body,null,c.length>0&&n.a.createElement("table",{className:"po-output"},n.a.createElement("thead",null,n.a.createElement("tr",null,Object.keys(c[0]).map((function(e,t){return n.a.createElement("td",{key:t},"".concat(e,"\t"))})))),n.a.createElement("tbody",null,c.map((function(e,t){return n.a.createElement("tr",{key:"item_".concat(t)},Object.keys(e).map((function(a,u){return n.a.createElement("td",{key:"item_".concat(t,"_").concat(u)},"".concat(e[a],"\t"))})))})),n.a.createElement("tr",null))))))};var g=function(){var e=n.a.useState(null),t=Object(s.a)(e,2),a=t[0],u=t[1],r=n.a.useState([]),l=Object(s.a)(r,2),c=l[0],A=l[1],x=n.a.useState(!1),v=Object(s.a)(x,2),g=v[0],y=v[1],O=n.a.useState(1),D=Object(s.a)(O,2),w=D[0],k=D[1],j=n.a.useState(1),P=Object(s.a)(j,2),N=P[0],C=P[1],S=n.a.useState(!1),Y=Object(s.a)(S,2),z=Y[0],_=Y[1],M=n.a.useState([]),B=Object(s.a)(M,2),R=B[0],I=B[1],T=n.a.createRef(),Z=function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=Array.from(e).map((function(e){return new Promise((function(t){var a=new FileReader;a.onload=function(u){var n,r,l,c,s,F,d;return o.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return n=window.pdfjsLib.getDocument({data:a.result}),u.next=3,o.a.awrap(n.promise.then((function(e){var t,a,u,n;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:t=e.numPages,a="",u=1;case 3:if(!(u<=t)){r.next=11;break}return r.next=6,o.a.awrap(e.getPage(u).then((function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.getTextContent().then((function(e){var t,a,u,n;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:for(t=e.items,a="",u=0;u<t.length;u++)n=t[u],a+=n.str+" ";return r.abrupt("return",a);case 4:case"end":return r.stop()}}))})));case 1:case"end":return t.stop()}}))})));case 6:n=r.sent,a+=" "+n;case 8:u++,r.next=3;break;case 11:return r.abrupt("return",a);case 12:case"end":return r.stop()}}))})));case 3:r=u.sent,console.log(r),l="",c="",s="",r.match(Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+No\.[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+)/i,{ponumber:1}))&&(l=r.match(Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+No\.[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+)/i,{ponumber:1})).groups.ponumber),r.match(Object(m.a)(/No\.?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{15})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{1,2}\x2D[0-9A-Z_a-z]{3}\x2D[0-9]{4})/i,{donumber:1,dodate:2}))&&(c=b(r.match(Object(m.a)(/No\.?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{15})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{1,2}\x2D[0-9A-Z_a-z]{3}\x2D[0-9]{4})/i,{donumber:1,dodate:2})).groups.dodate,"DD-MMM-YYYY").format("YYYY/MM/DD"),s=r.match(Object(m.a)(/No\.?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{15})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{1,2}\x2D[0-9A-Z_a-z]{3}\x2D[0-9]{4})/i,{donumber:1,dodate:2})).groups.donumber),F=r.matchAll(Object(m.a)(/([0-9]{1,2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+|[0-9]+.[0-9]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]{10})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{6})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+(.+?((?=([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]{1,2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+|[0-9]+.[0-9]+)))|(?=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+OCK Setia)|(?=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+RECEIVED)))/gim,{noitem:1,quantity:2,materialno:3,sitecode:4,UOM:5,description:6})),d=Array.from(F).map((function(e){return e.groups})).map((function(e){return Object(i.a)({},{ponumber:l,dodate:c,donumber:s},{},e)})),t({doDate:c,doNumber:s,poNumber:l,items:d||[],data:btoa(a.result),filename:e.name});case 11:case"end":return u.stop()}}))},a.readAsBinaryString(e)}))})),Promise.all(t).then((function(e){I(e),console.log(e)}));case 2:case"end":return a.stop()}}))},L=.8*window.innerWidth;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"dropFileArea",onDragOver:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;Z(t)}},n.a.createElement("div",{style:{display:"flex",height:"40px",verticalAlign:"middle"}},n.a.createElement("div",{style:{padding:"8px"}},"Drop multiple DO PDF files or"),n.a.createElement(d.a,{onClick:function(){T.current.click()}},"Select Files"),n.a.createElement("input",{type:"file",ref:T,onChange:function(e){var t=e.target.files;t.length>0&&Z(t)},style:{display:"none"},accept:".pdf",multiple:!0}))),n.a.createElement("div",{className:"actionArea"},R.length>0&&n.a.createElement(d.a,{variant:"secondary",onClick:function(){!function(){var e,t=R.flatMap((function(e){return e.items}));if((e=t.map((function(e){return Object.values(e)}))).length>0){var a=new h.a.Workbook,u=a.addWorksheet("PO");u.addRow(Object.keys(t[0])),u.addRows(e),a.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download="DO_Export.xlsx",a.click()}))}}()}},"Export to Excel")),n.a.createElement("div",{className:"itemsArea"},R.length>0&&n.a.createElement(E.a,{size:"sm",hover:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("td",null,"Filename"),n.a.createElement("td",null,"DO Number"),n.a.createElement("td",null,"DO Date"),n.a.createElement("td",null,"PO Number"),n.a.createElement("td",null,"Number of items"),n.a.createElement("td",null))),n.a.createElement("tbody",null,R.map((function(e,t){return n.a.createElement("tr",{key:t},n.a.createElement("td",null,e.filename),n.a.createElement("td",null,e.doNumber),n.a.createElement("td",null,e.doDate),n.a.createElement("td",null,e.poNumber),n.a.createElement("td",null,e.items.length),n.a.createElement("td",null,n.a.createElement(p.a,{size:"sm"},n.a.createElement(d.a,{onClick:function(){u(e.data),C(1),_(!0)}},"View PDF"),n.a.createElement(d.a,{onClick:function(){A(e.items),y(!0)}},"View Item"))))}))))),n.a.createElement(f.a,{centered:!0,scrollable:!0,show:z,onHide:function(){_(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(f.a.Header,{closeButton:!0},n.a.createElement(f.a.Title,null,"PDF Document")),n.a.createElement(f.a.Body,null,null!==a&&n.a.createElement(F.PDFReader,{data:atob(a),size:.7,onDocumentComplete:function(e){k(e)},page:N,width:L})),n.a.createElement(f.a.Footer,null,n.a.createElement("div",null,"Page ",N," of ",w),n.a.createElement(d.a,{variant:"secondary",onClick:function(){N-1>=0&&C(N-1)},disabled:1==N},"Previous"),n.a.createElement(d.a,{variant:"secondary",onClick:function(){N+1<=w&&C(N+1)},disabled:N==w},"Next"))),n.a.createElement(f.a,{centered:!0,scrollable:!0,show:g,onHide:function(){y(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(f.a.Header,{closeButton:!0},n.a.createElement(f.a.Title,null,"Items")),n.a.createElement(f.a.Body,null,c.length>0&&n.a.createElement("table",{className:"po-output"},n.a.createElement("thead",null,n.a.createElement("tr",null,Object.keys(c[0]).map((function(e,t){return n.a.createElement("td",{key:t},"".concat(e,"\t"))})))),n.a.createElement("tbody",null,c.map((function(e,t){return n.a.createElement("tr",{key:"item_".concat(t)},Object.keys(e).map((function(a,u){return n.a.createElement("td",{key:"item_".concat(t,"_").concat(u)},"".concat(e[a],"\t"))})))})),n.a.createElement("tr",null))))))},y=a(133),O=a.n(y);var D=function(e){var t=n.a.useRef(null),a=n.a.useState([]),u=Object(s.a)(a,2),r=u[0],l=u[1],c=n.a.useState([]),i=Object(s.a)(c,2),m=i[0],F=i[1],A=n.a.useState(!1),x=Object(s.a)(A,2),v=x[0],g=x[1],y=function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=Array.from(e).map((function(e){return new Promise((function(t){var a=new FileReader;a.onload=function(a){var u=a.target.result,n=O.a.read(u,{type:"binary"}),r=n.Sheets[n.SheetNames[0]],l=O.a.utils.sheet_to_json(r);console.log(l);var c={"Purchase Contract":"",Date:"","Issue No.":"","Project No.":"","Contract No.":""},o=["Line","Project Area","Site ID ","Site Name","Item Num","Description","Remark","Unit","Qty","Unit Price","Amount"],i=null,m=null,F=[];l.forEach((function(e){if(Object.entries(e).forEach((function(e){var t=Object(s.a)(e,2),a=(t[0],t[1]);a in c?""===c[a]&&(i=a):null!==i&&(c[i]=a,i=null)})),Object.entries(e).every((function(e){var t=Object(s.a)(e,2),a=(t[0],t[1]);return o.includes(a)})))m=e;else if(null!==m)if(Object.values(e).length<5)m=null;else{var t=Object.entries(m).reduce((function(t,a){var u=Object(s.a)(a,2),n=u[0],r=u[1];return n in e&&(t[r]=e[n]),t}),{});F.push(t)}})),F.forEach((function(e){Object.entries(c).forEach((function(t){var a=Object(s.a)(t,2),u=a[0],n=a[1];e[u]=n}))}));var d={poDate:c.Date,poNumber:c["Purchase Contract"],items:F||[],filename:e.name};t(d)},a.readAsBinaryString(e)}))})),Promise.all(t).then((function(e){console.log(e),l(e)}));case 2:case"end":return a.stop()}}))},D=function(){var e=[],t=r.flatMap((function(e){return e.items}));if((e=t.map((function(e){return Object.values(e)}))).length>0){var a=new h.a.Workbook,u=a.addWorksheet("PO");u.addRow(Object.keys(t[0])),console.log(Object.keys(t[0])),console.log(e),Object.keys(t[0]).forEach((function(t,a){t.match(/date/g)&&(console.log("Convert column ".concat(a+1," to date format")),u.getColumn("".concat(function(e){for(var t="",a=1,u=26;(e-=a)>=0;a=u,u*=26)t=String.fromCharCode(parseInt(e%u/a)+65)+t;return t}(a+1))).numFmt="d-mmm-yy",e.forEach((function(e){e[a]=b.utc(e[a],"YYYY/MM/DD").toDate()})))})),u.addRows(e),a.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download="PO_Export.xlsx",a.click()}))}};return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"dropFileArea",onDragOver:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;y(t)}},n.a.createElement("div",{style:{display:"flex",height:"40px",verticalAlign:"middle"}},n.a.createElement("div",{style:{padding:"8px"}},"Drop multiple PO Excels files or"),n.a.createElement(d.a,{onClick:function(){t.current.click()}},"Select Files"),n.a.createElement("input",{type:"file",ref:t,onChange:function(e){var t=e.target.files;t.length>0&&y(t)},style:{display:"none"},accept:".xlsx, .xls",multiple:!0}))),n.a.createElement("div",{className:"actionArea"},r.length>0&&n.a.createElement(d.a,{variant:"secondary",onClick:function(){D()}},"Export to Excel")),n.a.createElement("div",{className:"itemsArea"},r.length>0&&n.a.createElement(E.a,{size:"sm",hover:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("td",null,"Filename"),n.a.createElement("td",null,"PO Number"),n.a.createElement("td",null,"PO Date"),n.a.createElement("td",null,"Number of items"),n.a.createElement("td",null))),n.a.createElement("tbody",null,r.map((function(e,t){return n.a.createElement("tr",{key:t},n.a.createElement("td",null,e.filename),n.a.createElement("td",null,e.poNumber),n.a.createElement("td",null,e.poDate),n.a.createElement("td",null,e.items.length),n.a.createElement("td",null,n.a.createElement(p.a,{size:"sm"},n.a.createElement(d.a,{onClick:function(){F(e.items),g(!0)}},"View Item"))))}))))),n.a.createElement(f.a,{centered:!0,scrollable:!0,show:v,onHide:function(){g(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(f.a.Header,{closeButton:!0},n.a.createElement(f.a.Title,null,"Items")),n.a.createElement(f.a.Body,null,m.length>0&&n.a.createElement("table",{className:"po-output"},n.a.createElement("thead",null,n.a.createElement("tr",null,Object.keys(m[0]).map((function(e,t){return n.a.createElement("td",{key:t},"".concat(e,"\t"))})))),n.a.createElement("tbody",null,m.map((function(e,t){return n.a.createElement("tr",{key:"item_".concat(t)},Object.keys(e).map((function(a,u){return n.a.createElement("td",{key:"item_".concat(t,"_").concat(u)},"".concat(e[a],"\t"))})))})),n.a.createElement("tr",null))))))},w=a(361),k=a(360),j=a(75),P=a(47);var N=function(e){return n.a.createElement(j.a,{basename:"poer"},n.a.createElement(w.a,{bg:"dark",variant:"dark"},n.a.createElement(w.a.Brand,null,"PDF Extract"),n.a.createElement(k.a,{className:"mr-auto"},n.a.createElement(k.a.Link,{as:j.b,to:"po",activeStyle:{color:"white"}},"Purchase Order (PDF)"),n.a.createElement(k.a.Link,{as:j.b,to:"do",activeStyle:{color:"white"}},"Delivery Order"),n.a.createElement(k.a.Link,{as:j.b,to:"excelpo",activeStyle:{color:"white"}},"Purchase Order (Excel)"))),n.a.createElement("div",{className:"App"},n.a.createElement(P.d,null,n.a.createElement(P.b,{path:"/po"},n.a.createElement(v,null)),n.a.createElement(P.b,{path:"/do"},n.a.createElement(g,null)),n.a.createElement(P.b,{path:"/excelpo"},n.a.createElement(D,null)),n.a.createElement(P.b,{path:"/"},n.a.createElement(P.a,{to:{pathname:"po"}})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[207,1,2]]]);
//# sourceMappingURL=main.be78b8d5.chunk.js.map