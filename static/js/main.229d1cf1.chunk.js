(this.webpackJsonppore=this.webpackJsonppore||[]).push([[0],{174:function(e,t){},207:function(e,t,a){e.exports=a(345)},212:function(e,t,a){},213:function(e,t,a){},340:function(e,t){},341:function(e,t){},345:function(e,t,a){"use strict";a.r(t);var n=a(0),u=a.n(n),r=a(22),l=a.n(r),c=(a(212),a(213),a(25)),o=a.n(c),i=a(94),m=a(24),s=a(17),d=a(95),F=a(355),E=a(356),f=a(357),p=a(359),b=(a(76),a(358)),A=(a(141),a(44)),h=a(64),x=a.n(h);var v=function(){var e=u.a.useState(null),t=Object(s.a)(e,2),a=t[0],n=t[1],r=u.a.useState([]),l=Object(s.a)(r,2),c=l[0],h=l[1],v=u.a.useState(!1),g=Object(s.a)(v,2),y=g[0],O=g[1],D=u.a.useState(1),w=Object(s.a)(D,2),k=w[0],j=w[1],P=u.a.useState(1),N=Object(s.a)(P,2),C=N[0],S=N[1],Y=u.a.useState(!1),_=Object(s.a)(Y,2),z=_[0],B=_[1],M=u.a.useState([]),R=Object(s.a)(M,2),I=R[0],T=R[1],L=u.a.useState("webe"),W=Object(s.a)(L,2),Z=W[0],H=W[1],U={webe:{poNumber:Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Number[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+)/,{ponumber:1}),poDate:Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+[\x2D\.\\\|][0-9]+[\x2D\.\\\|][0-9]+)/,{podate:1}),items:Object(m.a)(/([0-9]{1,2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]{10})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF](.+?)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]{1,2}\.[0-9]{1,2}\.[0-9]{4})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]+|[0-9]+.[0-9]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9A-Z_a-z]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]+,?[0-9]*\.[0-9]{2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]*,?[0-9]+\.[0-9]{2})/gm,{item:1,materialno:2,description:3,date:4,quantity:5,quantifier:6,unitprice:7,totalprice:8})},ericssondigi:{poNumber:Object(m.a)(/Purchase Order[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{10})/,{ponumber:1}),poDate:Object(m.a)(/Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{2}\.[0-9]{2}\.[0-9]{4})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\(DD\.MM\.YYYY\)/,{podate:1}),items:Object(m.a)(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]{5})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+(.{1,50})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+\.?[0-9]*)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+(,[0-9]{3})*\.[0-9]{2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+(,[0-9]{3})*\.[0-9]{2})(.+?)([0-9]{4}[A-Za-z\|](_[0-9])?)/gm,{itemno:1,description:2,quantity:3,unit:4,unitprice:5,linevalue:7,siteid:10})}},V=u.a.createRef(),q=function(){var e=[],t=I.flatMap((function(e){return e.items}));if((e=t.map((function(e){return Object.values(e)}))).length>0){var a=new x.a.Workbook,n=a.addWorksheet("PO");n.addRow(Object.keys(t[0])),console.log(Object.keys(t[0])),console.log(e),Object.keys(t[0]).forEach((function(t,a){t.match(/date/g)&&(console.log("Convert column ".concat(a+1," to date format")),n.getColumn("".concat(function(e){for(var t="",a=1,n=26;(e-=a)>=0;a=n,n*=26)t=String.fromCharCode(parseInt(e%n/a)+65)+t;return t}(a+1))).numFmt="d-mmm-yy",e.forEach((function(e){e[a]=A.utc(e[a],"YYYY/MM/DD").toDate()})))})),n.addRows(e),a.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download="PO_Export.xlsx",a.click()}))}},J=function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=Array.from(e).map((function(e){return new Promise((function(t){var a=new FileReader;a.onload=function(n){var u=window.pdf2text(btoa(a.result));console.log(u);var r="",l="";u.match(U[Z].poNumber)&&(r=u.match(U[Z].poNumber).groups.ponumber,console.log(r)),u.match(U[Z].poDate)&&(l=A(u.match(U[Z].poDate).groups.podate,"DD.MM.YYYY").format("YYYY/MM/DD"));var c=u.matchAll(U[Z].items),o=Array.from(c).map((function(e){return e.groups})).map((function(e){return Object(i.a)({},{ponumber:r,podate:l},{},e)}));o.forEach((function(e){"date"in e&&(e.date=A(e.date,"DD.MM.YYYY").format("YYYY/MM/DD"))})),t({poDate:l,poNumber:r,items:o||[],data:btoa(a.result),filename:e.name})},a.readAsBinaryString(e)}))})),Promise.all(t).then((function(e){T(e),console.log(e)}));case 2:case"end":return a.stop()}}))},K=.8*window.innerWidth;return u.a.createElement(u.a.Fragment,null,u.a.createElement(b.a,{style:{marginBottom:"10px"}},u.a.createElement(b.a.Select,{label:"Select PO type",options:[{key:"webe",value:"webe",text:"Webe PO"},{key:"ericssondigi",value:"ericssondigi",text:"Ericssion Digi PO"}],value:Z,onChange:function(e,t){var a=t.value;return H(a)}})),u.a.createElement("div",{className:"dropFileArea",onDragOver:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;J(t)}},u.a.createElement("div",{style:{display:"flex",height:"40px",verticalAlign:"middle"}},u.a.createElement("div",{style:{padding:"8px"}},"Drop multiple PO PDF files or"),u.a.createElement(F.a,{onClick:function(){V.current.click()}},"Select Files"),u.a.createElement("input",{type:"file",ref:V,onChange:function(e){var t=e.target.files;t.length>0&&J(t)},style:{display:"none"},accept:".pdf",multiple:!0}))),u.a.createElement("div",{className:"actionArea"},I.length>0&&u.a.createElement(F.a,{variant:"secondary",onClick:function(){q()}},"Export to Excel")),u.a.createElement("div",{className:"itemsArea"},I.length>0&&u.a.createElement(E.a,{size:"sm",hover:!0},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("td",null,"Filename"),u.a.createElement("td",null,"PO Number"),u.a.createElement("td",null,"PO Date"),u.a.createElement("td",null,"Number of items"),u.a.createElement("td",null))),u.a.createElement("tbody",null,I.map((function(e,t){return u.a.createElement("tr",{key:t},u.a.createElement("td",null,e.filename),u.a.createElement("td",null,e.poNumber),u.a.createElement("td",null,e.poDate),u.a.createElement("td",null,e.items.length),u.a.createElement("td",null,u.a.createElement(f.a,{size:"sm"},u.a.createElement(F.a,{onClick:function(){n(e.data),S(1),B(!0)}},"View PDF"),u.a.createElement(F.a,{onClick:function(){h(e.items),O(!0)}},"View Item"))))}))))),u.a.createElement(p.a,{centered:!0,scrollable:!0,show:z,onHide:function(){B(!1)},dialogClassName:"pdf-modal",size:"xl"},u.a.createElement(p.a.Header,{closeButton:!0},u.a.createElement(p.a.Title,null,"PDF Document")),u.a.createElement(p.a.Body,null,null!==a&&u.a.createElement(d.PDFReader,{data:atob(a),size:.7,onDocumentComplete:function(e){j(e)},page:C,width:K})),u.a.createElement(p.a.Footer,null,u.a.createElement("div",null,"Page ",C," of ",k),u.a.createElement(F.a,{variant:"secondary",onClick:function(){C-1>=0&&S(C-1)},disabled:1==C},"Previous"),u.a.createElement(F.a,{variant:"secondary",onClick:function(){C+1<=k&&S(C+1)},disabled:C==k},"Next"))),u.a.createElement(p.a,{centered:!0,scrollable:!0,show:y,onHide:function(){O(!1)},dialogClassName:"pdf-modal",size:"xl"},u.a.createElement(p.a.Header,{closeButton:!0},u.a.createElement(p.a.Title,null,"Items")),u.a.createElement(p.a.Body,null,c.length>0&&u.a.createElement("table",{className:"po-output"},u.a.createElement("thead",null,u.a.createElement("tr",null,Object.keys(c[0]).map((function(e,t){return u.a.createElement("td",{key:t},"".concat(e,"\t"))})))),u.a.createElement("tbody",null,c.map((function(e,t){return u.a.createElement("tr",{key:"item_".concat(t)},Object.keys(e).map((function(a,n){return u.a.createElement("td",{key:"item_".concat(t,"_").concat(n)},"".concat(e[a],"\t"))})))})),u.a.createElement("tr",null))))))};var g=function(){var e=u.a.useState(null),t=Object(s.a)(e,2),a=t[0],n=t[1],r=u.a.useState([]),l=Object(s.a)(r,2),c=l[0],b=l[1],h=u.a.useState(!1),v=Object(s.a)(h,2),g=v[0],y=v[1],O=u.a.useState(1),D=Object(s.a)(O,2),w=D[0],k=D[1],j=u.a.useState(1),P=Object(s.a)(j,2),N=P[0],C=P[1],S=u.a.useState(!1),Y=Object(s.a)(S,2),_=Y[0],z=Y[1],B=u.a.useState([]),M=Object(s.a)(B,2),R=M[0],I=M[1],T=u.a.createRef(),L=function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=Array.from(e).map((function(e){return new Promise((function(t){var a=new FileReader;a.onload=function(n){var u,r,l,c,s,d,F;return o.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return u=window.pdfjsLib.getDocument({data:a.result}),n.next=3,o.a.awrap(u.promise.then((function(e){var t,a,n,u;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:t=e.numPages,a="",n=1;case 3:if(!(n<=t)){r.next=11;break}return r.next=6,o.a.awrap(e.getPage(n).then((function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.getTextContent().then((function(e){var t,a,n,u;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:for(t=e.items,a="",n=0;n<t.length;n++)u=t[n],a+=u.str+" ";return r.abrupt("return",a);case 4:case"end":return r.stop()}}))})));case 1:case"end":return t.stop()}}))})));case 6:u=r.sent,a+=" "+u;case 8:n++,r.next=3;break;case 11:return r.abrupt("return",a);case 12:case"end":return r.stop()}}))})));case 3:r=n.sent,console.log(r),l="",c="",s="",r.match(Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+No\.[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+)/i,{ponumber:1}))&&(l=r.match(Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+No\.[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+)/i,{ponumber:1})).groups.ponumber),r.match(Object(m.a)(/No\.?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{15})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{1,2}\x2D[0-9A-Z_a-z]{3}\x2D[0-9]{4})/i,{donumber:1,dodate:2}))&&(c=A(r.match(Object(m.a)(/No\.?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{15})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{1,2}\x2D[0-9A-Z_a-z]{3}\x2D[0-9]{4})/i,{donumber:1,dodate:2})).groups.dodate,"DD-MMM-YYYY").format("YYYY/MM/DD"),s=r.match(Object(m.a)(/No\.?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{15})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{1,2}\x2D[0-9A-Z_a-z]{3}\x2D[0-9]{4})/i,{donumber:1,dodate:2})).groups.donumber),d=r.matchAll(Object(m.a)(/([0-9]{1,2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+|[0-9]+.[0-9]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]{10})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{6})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+(.+?((?=([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]{1,2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+|[0-9]+.[0-9]+)))|(?=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+OCK Setia)|(?=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+RECEIVED)))/gim,{noitem:1,quantity:2,materialno:3,sitecode:4,UOM:5,description:6})),F=Array.from(d).map((function(e){return e.groups})).map((function(e){return Object(i.a)({},{ponumber:l,dodate:c,donumber:s},{},e)})),t({doDate:c,doNumber:s,poNumber:l,items:F||[],data:btoa(a.result),filename:e.name});case 11:case"end":return n.stop()}}))},a.readAsBinaryString(e)}))})),Promise.all(t).then((function(e){I(e),console.log(e)}));case 2:case"end":return a.stop()}}))},W=.8*window.innerWidth;return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"dropFileArea",onDragOver:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;L(t)}},u.a.createElement("div",{style:{display:"flex",height:"40px",verticalAlign:"middle"}},u.a.createElement("div",{style:{padding:"8px"}},"Drop multiple DO PDF files or"),u.a.createElement(F.a,{onClick:function(){T.current.click()}},"Select Files"),u.a.createElement("input",{type:"file",ref:T,onChange:function(e){var t=e.target.files;t.length>0&&L(t)},style:{display:"none"},accept:".pdf",multiple:!0}))),u.a.createElement("div",{className:"actionArea"},R.length>0&&u.a.createElement(F.a,{variant:"secondary",onClick:function(){!function(){var e,t=R.flatMap((function(e){return e.items}));if((e=t.map((function(e){return Object.values(e)}))).length>0){var a=new x.a.Workbook,n=a.addWorksheet("PO");n.addRow(Object.keys(t[0])),n.addRows(e),a.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download="DO_Export.xlsx",a.click()}))}}()}},"Export to Excel")),u.a.createElement("div",{className:"itemsArea"},R.length>0&&u.a.createElement(E.a,{size:"sm",hover:!0},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("td",null,"Filename"),u.a.createElement("td",null,"DO Number"),u.a.createElement("td",null,"DO Date"),u.a.createElement("td",null,"PO Number"),u.a.createElement("td",null,"Number of items"),u.a.createElement("td",null))),u.a.createElement("tbody",null,R.map((function(e,t){return u.a.createElement("tr",{key:t},u.a.createElement("td",null,e.filename),u.a.createElement("td",null,e.doNumber),u.a.createElement("td",null,e.doDate),u.a.createElement("td",null,e.poNumber),u.a.createElement("td",null,e.items.length),u.a.createElement("td",null,u.a.createElement(f.a,{size:"sm"},u.a.createElement(F.a,{onClick:function(){n(e.data),C(1),z(!0)}},"View PDF"),u.a.createElement(F.a,{onClick:function(){b(e.items),y(!0)}},"View Item"))))}))))),u.a.createElement(p.a,{centered:!0,scrollable:!0,show:_,onHide:function(){z(!1)},dialogClassName:"pdf-modal",size:"xl"},u.a.createElement(p.a.Header,{closeButton:!0},u.a.createElement(p.a.Title,null,"PDF Document")),u.a.createElement(p.a.Body,null,null!==a&&u.a.createElement(d.PDFReader,{data:atob(a),size:.7,onDocumentComplete:function(e){k(e)},page:N,width:W})),u.a.createElement(p.a.Footer,null,u.a.createElement("div",null,"Page ",N," of ",w),u.a.createElement(F.a,{variant:"secondary",onClick:function(){N-1>=0&&C(N-1)},disabled:1==N},"Previous"),u.a.createElement(F.a,{variant:"secondary",onClick:function(){N+1<=w&&C(N+1)},disabled:N==w},"Next"))),u.a.createElement(p.a,{centered:!0,scrollable:!0,show:g,onHide:function(){y(!1)},dialogClassName:"pdf-modal",size:"xl"},u.a.createElement(p.a.Header,{closeButton:!0},u.a.createElement(p.a.Title,null,"Items")),u.a.createElement(p.a.Body,null,c.length>0&&u.a.createElement("table",{className:"po-output"},u.a.createElement("thead",null,u.a.createElement("tr",null,Object.keys(c[0]).map((function(e,t){return u.a.createElement("td",{key:t},"".concat(e,"\t"))})))),u.a.createElement("tbody",null,c.map((function(e,t){return u.a.createElement("tr",{key:"item_".concat(t)},Object.keys(e).map((function(a,n){return u.a.createElement("td",{key:"item_".concat(t,"_").concat(n)},"".concat(e[a],"\t"))})))})),u.a.createElement("tr",null))))))},y=a(133),O=a.n(y);var D=function(e){var t=u.a.useRef(null),a=u.a.useState([]),n=Object(s.a)(a,2),r=n[0],l=n[1],c=u.a.useState([]),i=Object(s.a)(c,2),m=i[0],d=i[1],b=u.a.useState(!1),h=Object(s.a)(b,2),v=h[0],g=h[1],y=function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=Array.from(e).map((function(e){return new Promise((function(t){var a=new FileReader;a.onload=function(a){var n=a.target.result,u=O.a.read(n,{type:"binary"}),r=u.Sheets[u.SheetNames[0]],l=O.a.utils.sheet_to_json(r);console.log(l);var c={"Purchase Contract":"",Date:"","Issue No.":"","Project No.":"","Contract No.":""},o=["Line","Project Area","Site ID ","Site Name","Item Num","Description","Remark","Unit","Qty","Unit Price","Amount"],i=null,m=null,d=[];l.forEach((function(e){if(Object.entries(e).forEach((function(e){var t=Object(s.a)(e,2),a=(t[0],t[1]);a in c?""===c[a]&&(i=a):null!==i&&(c[i]=a,i=null)})),Object.entries(e).every((function(e){var t=Object(s.a)(e,2),a=(t[0],t[1]);return o.includes(a)})))m=e;else if(null!==m)if(Object.values(e).length<5)m=null;else{var t=Object.entries(m).reduce((function(t,a){var n=Object(s.a)(a,2),u=n[0],r=n[1];return u in e&&(t[r]=e[u]),t}),{});d.push(t)}})),d.forEach((function(e){Object.entries(c).forEach((function(t){var a=Object(s.a)(t,2),n=a[0],u=a[1];e[n]=u}))}));var F={poDate:c.Date,poNumber:c["Purchase Contract"],items:d||[],filename:e.name};t(F)},a.readAsBinaryString(e)}))})),Promise.all(t).then((function(e){console.log(e),l(e)}));case 2:case"end":return a.stop()}}))},D=function(){var e=[],t=r.flatMap((function(e){return e.items}));if((e=t.map((function(e){return Object.values(e)}))).length>0){var a=new x.a.Workbook,n=a.addWorksheet("PO");n.addRow(Object.keys(t[0])),console.log(Object.keys(t[0])),console.log(e),Object.keys(t[0]).forEach((function(t,a){t.match(/date/g)&&(console.log("Convert column ".concat(a+1," to date format")),n.getColumn("".concat(function(e){for(var t="",a=1,n=26;(e-=a)>=0;a=n,n*=26)t=String.fromCharCode(parseInt(e%n/a)+65)+t;return t}(a+1))).numFmt="d-mmm-yy",e.forEach((function(e){e[a]=A.utc(e[a],"YYYY/MM/DD").toDate()})))})),n.addRows(e),a.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download="PO_Export.xlsx",a.click()}))}};return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"dropFileArea",onDragOver:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;y(t)}},u.a.createElement("div",{style:{display:"flex",height:"40px",verticalAlign:"middle"}},u.a.createElement("div",{style:{padding:"8px"}},"Drop multiple PO Excels files or"),u.a.createElement(F.a,{onClick:function(){t.current.click()}},"Select Files"),u.a.createElement("input",{type:"file",ref:t,onChange:function(e){var t=e.target.files;t.length>0&&y(t)},style:{display:"none"},accept:".xlsx, .xls",multiple:!0}))),u.a.createElement("div",{className:"actionArea"},r.length>0&&u.a.createElement(F.a,{variant:"secondary",onClick:function(){D()}},"Export to Excel")),u.a.createElement("div",{className:"itemsArea"},r.length>0&&u.a.createElement(E.a,{size:"sm",hover:!0},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("td",null,"Filename"),u.a.createElement("td",null,"PO Number"),u.a.createElement("td",null,"PO Date"),u.a.createElement("td",null,"Number of items"),u.a.createElement("td",null))),u.a.createElement("tbody",null,r.map((function(e,t){return u.a.createElement("tr",{key:t},u.a.createElement("td",null,e.filename),u.a.createElement("td",null,e.poNumber),u.a.createElement("td",null,e.poDate),u.a.createElement("td",null,e.items.length),u.a.createElement("td",null,u.a.createElement(f.a,{size:"sm"},u.a.createElement(F.a,{onClick:function(){d(e.items),g(!0)}},"View Item"))))}))))),u.a.createElement(p.a,{centered:!0,scrollable:!0,show:v,onHide:function(){g(!1)},dialogClassName:"pdf-modal",size:"xl"},u.a.createElement(p.a.Header,{closeButton:!0},u.a.createElement(p.a.Title,null,"Items")),u.a.createElement(p.a.Body,null,m.length>0&&u.a.createElement("table",{className:"po-output"},u.a.createElement("thead",null,u.a.createElement("tr",null,Object.keys(m[0]).map((function(e,t){return u.a.createElement("td",{key:t},"".concat(e,"\t"))})))),u.a.createElement("tbody",null,m.map((function(e,t){return u.a.createElement("tr",{key:"item_".concat(t)},Object.keys(e).map((function(a,n){return u.a.createElement("td",{key:"item_".concat(t,"_").concat(n)},"".concat(e[a],"\t"))})))})),u.a.createElement("tr",null))))))},w=a(361),k=a(360),j=a(75),P=a(47);var N=function(e){return u.a.createElement(j.a,{basename:"poer"},u.a.createElement(w.a,{bg:"dark",variant:"dark"},u.a.createElement(w.a.Brand,null,"PDF Extract"),u.a.createElement(k.a,{className:"mr-auto"},u.a.createElement(k.a.Link,{as:j.b,to:"po",activeStyle:{color:"white"}},"Purchase Order (PDF)"),u.a.createElement(k.a.Link,{as:j.b,to:"do",activeStyle:{color:"white"}},"Delivery Order"),u.a.createElement(k.a.Link,{as:j.b,to:"excelpo",activeStyle:{color:"white"}},"Purchase Order (Excel)"))),u.a.createElement("div",{className:"App"},u.a.createElement(P.d,null,u.a.createElement(P.b,{path:"/po"},u.a.createElement(v,null)),u.a.createElement(P.b,{path:"/do"},u.a.createElement(g,null)),u.a.createElement(P.b,{path:"/excelpo"},u.a.createElement(D,null)),u.a.createElement(P.b,{path:"/"},u.a.createElement(P.a,{to:{pathname:"po"}})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(u.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[207,1,2]]]);
//# sourceMappingURL=main.229d1cf1.chunk.js.map