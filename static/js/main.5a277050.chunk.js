(this.webpackJsonppore=this.webpackJsonppore||[]).push([[0],{53:function(e,t,a){e.exports=a(68)},58:function(e,t,a){},59:function(e,t,a){},68:function(e,t,a){"use strict";a.r(t);var u=a(0),n=a.n(u),r=a(16),l=a.n(r),c=(a(58),a(59),a(13)),o=a.n(c),i=a(35),m=a(9),F=a(7),s=a(28),d=a(70),E=a(71),p=a(72),f=a(73),A=(a(38),a(26)),x=a(29),b=a.n(x);var h=function(){var e=n.a.useState(null),t=Object(F.a)(e,2),a=t[0],u=t[1],r=n.a.useState([]),l=Object(F.a)(r,2),c=l[0],x=l[1],h=n.a.useState(!1),v=Object(F.a)(h,2),g=v[0],y=v[1],D=n.a.useState(1),w=Object(F.a)(D,2),O=w[0],k=w[1],j=n.a.useState(1),P=Object(F.a)(j,2),N=P[0],Y=P[1],C=n.a.useState(!1),S=Object(F.a)(C,2),z=S[0],B=S[1],_=n.a.useState([]),M=Object(F.a)(_,2),R=M[0],T=M[1],Z=n.a.createRef(),H=function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=Array.from(e).map((function(e){return new Promise((function(t){var a=new FileReader;a.onload=function(u){var n=window.pdf2text(btoa(a.result)),r="",l="";n.match(Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Number[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+)/,{ponumber:1}))&&(r=n.match(Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Number[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+)/,{ponumber:1})).groups.ponumber),n.match(Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+[\x2D\.\\\|][0-9]+[\x2D\.\\\|][0-9]+)/,{podate:1}))&&(l=A(n.match(Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+[\x2D\.\\\|][0-9]+[\x2D\.\\\|][0-9]+)/,{podate:1})).groups.podate,"DD.MM.YYYY").format("YYYY/MM/DD"));var c=n.matchAll(Object(m.a)(/([0-9]{1,2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]{10})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF](.+?)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]{1,2}\.[0-9]{1,2}\.[0-9]{4})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]+|[0-9]+.[0-9]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9A-Z_a-z]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]+,?[0-9]*\.[0-9]{2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]([0-9]*,?[0-9]+\.[0-9]{2})/gm,{item:1,materialno:2,description:3,date:4,quantity:5,quantifier:6,unitprice:7,totalprice:8})),o=Array.from(c).map((function(e){return e.groups})).map((function(e){return Object(i.a)({},{ponumber:r,podate:l},{},e)}));o.forEach((function(e){e.date=A(e.date,"DD.MM.YYYY").format("YYYY/MM/DD")})),t({poDate:l,poNumber:r,items:o||[],data:btoa(a.result),filename:e.name})},a.readAsBinaryString(e)}))})),Promise.all(t).then((function(e){T(e),console.log(e)}));case 2:case"end":return a.stop()}}))},W=.8*window.innerWidth;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"dropFileArea",onDragOver:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;H(t)}},n.a.createElement("div",{style:{display:"flex",height:"40px",verticalAlign:"middle"}},n.a.createElement("div",{style:{padding:"8px"}},"Drop multiple PO PDF files or"),n.a.createElement(d.a,{onClick:function(){Z.current.click()}},"Select Files"),n.a.createElement("input",{type:"file",ref:Z,onChange:function(e){var t=e.target.files;t.length>0&&H(t)},style:{display:"none"},accept:".pdf",multiple:!0}))),n.a.createElement("div",{className:"actionArea"},R.length>0&&n.a.createElement(d.a,{variant:"secondary",onClick:function(){!function(){var e,t=R.flatMap((function(e){return e.items}));if((e=t.map((function(e){return Object.values(e)}))).length>0){var a=new b.a.Workbook,u=a.addWorksheet("PO");u.addRow(Object.keys(t[0])),u.addRows(e),a.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download="PO_Export.xlsx",a.click()}))}}()}},"Export to Excel")),n.a.createElement("div",{className:"itemsArea"},R.length>0&&n.a.createElement(E.a,{size:"sm",hover:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("td",null,"Filename"),n.a.createElement("td",null,"PO Number"),n.a.createElement("td",null,"PO Date"),n.a.createElement("td",null,"Number of items"),n.a.createElement("td",null))),n.a.createElement("tbody",null,R.map((function(e,t){return n.a.createElement("tr",{key:t},n.a.createElement("td",null,e.filename),n.a.createElement("td",null,e.poDate),n.a.createElement("td",null,e.poNumber),n.a.createElement("td",null,e.items.length),n.a.createElement("td",null,n.a.createElement(p.a,{size:"sm"},n.a.createElement(d.a,{onClick:function(){u(e.data),Y(1),B(!0)}},"View PDF"),n.a.createElement(d.a,{onClick:function(){x(e.items),y(!0)}},"View Item"))))}))))),n.a.createElement(f.a,{centered:!0,scrollable:!0,show:z,onHide:function(){B(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(f.a.Header,{closeButton:!0},n.a.createElement(f.a.Title,null,"PDF Document")),n.a.createElement(f.a.Body,null,null!==a&&n.a.createElement(s.PDFReader,{data:atob(a),size:.7,onDocumentComplete:function(e){k(e)},page:N,width:W})),n.a.createElement(f.a.Footer,null,n.a.createElement("div",null,"Page ",N," of ",O),n.a.createElement(d.a,{variant:"secondary",onClick:function(){N-1>=0&&Y(N-1)},disabled:1==N},"Previous"),n.a.createElement(d.a,{variant:"secondary",onClick:function(){N+1<=O&&Y(N+1)},disabled:N==O},"Next"))),n.a.createElement(f.a,{centered:!0,scrollable:!0,show:g,onHide:function(){y(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(f.a.Header,{closeButton:!0},n.a.createElement(f.a.Title,null,"Items")),n.a.createElement(f.a.Body,null,c.length>0&&n.a.createElement("table",{className:"po-output"},n.a.createElement("thead",null,n.a.createElement("tr",null,Object.keys(c[0]).map((function(e,t){return n.a.createElement("td",{key:t},"".concat(e,"\t"))})))),n.a.createElement("tbody",null,c.map((function(e,t){return n.a.createElement("tr",{key:"item_".concat(t)},Object.keys(e).map((function(a,u){return n.a.createElement("td",{key:"item_".concat(t,"_").concat(u)},"".concat(e[a],"\t"))})))})),n.a.createElement("tr",null))))))};var v=function(){var e=n.a.useState(null),t=Object(F.a)(e,2),a=t[0],u=t[1],r=n.a.useState([]),l=Object(F.a)(r,2),c=l[0],x=l[1],h=n.a.useState(!1),v=Object(F.a)(h,2),g=v[0],y=v[1],D=n.a.useState(1),w=Object(F.a)(D,2),O=w[0],k=w[1],j=n.a.useState(1),P=Object(F.a)(j,2),N=P[0],Y=P[1],C=n.a.useState(!1),S=Object(F.a)(C,2),z=S[0],B=S[1],_=n.a.useState([]),M=Object(F.a)(_,2),R=M[0],T=M[1],Z=n.a.createRef(),H=function(e){var t;return o.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t=Array.from(e).map((function(e){return new Promise((function(t){var a=new FileReader;a.onload=function(u){var n,r,l,c,F,s,d;return o.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return n=window.pdfjsLib.getDocument({data:a.result}),u.next=3,o.a.awrap(n.promise.then((function(e){var t,a,u,n;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:t=e.numPages,a="",u=1;case 3:if(!(u<=t)){r.next=11;break}return r.next=6,o.a.awrap(e.getPage(u).then((function(e){return o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.getTextContent().then((function(e){var t,a,u,n;return o.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:for(t=e.items,a="",u=0;u<t.length;u++)n=t[u],a+=n.str+" ";return r.abrupt("return",a);case 4:case"end":return r.stop()}}))})));case 1:case"end":return t.stop()}}))})));case 6:n=r.sent,a+=" "+n;case 8:u++,r.next=3;break;case 11:return r.abrupt("return",a);case 12:case"end":return r.stop()}}))})));case 3:r=u.sent,console.log(r),l="",c="",F="",r.match(Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+No\.[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+)/i,{ponumber:1}))&&(l=r.match(Object(m.a)(/PO[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+No\.[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]+)/i,{ponumber:1})).groups.ponumber),r.match(Object(m.a)(/No\.?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{15})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{1,2}\x2D[0-9A-Z_a-z]{3}\x2D[0-9]{4})/i,{donumber:1,dodate:2}))&&(c=A(r.match(Object(m.a)(/No\.?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{15})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{1,2}\x2D[0-9A-Z_a-z]{3}\x2D[0-9]{4})/i,{donumber:1,dodate:2})).groups.dodate,"DD-MMM-YYYY").format("YYYY/MM/DD"),F=r.match(Object(m.a)(/No\.?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{15})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+Date[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*([0-9]{1,2}\x2D[0-9A-Z_a-z]{3}\x2D[0-9]{4})/i,{donumber:1,dodate:2})).groups.donumber),s=r.matchAll(Object(m.a)(/([0-9]{1,2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+|[0-9]+.[0-9]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]{10})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]{6})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9A-Z_a-z]+)[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+(.+?((?=([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]{1,2})[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+([0-9]+|[0-9]+.[0-9]+)))|(?=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+OCK Setia)|(?=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+RECEIVED)))/gim,{noitem:1,quantity:2,materialno:3,sitecode:4,UOM:5,description:6})),d=Array.from(s).map((function(e){return e.groups})).map((function(e){return Object(i.a)({},{ponumber:l,dodate:c,donumber:F},{},e)})),t({doDate:c,doNumber:F,poNumber:l,items:d||[],data:btoa(a.result),filename:e.name});case 11:case"end":return u.stop()}}))},a.readAsBinaryString(e)}))})),Promise.all(t).then((function(e){T(e),console.log(e)}));case 2:case"end":return a.stop()}}))},W=.8*window.innerWidth;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"dropFileArea",onDragOver:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;H(t)}},n.a.createElement("div",{style:{display:"flex",height:"40px",verticalAlign:"middle"}},n.a.createElement("div",{style:{padding:"8px"}},"Drop multiple DO PDF files or"),n.a.createElement(d.a,{onClick:function(){Z.current.click()}},"Select Files"),n.a.createElement("input",{type:"file",ref:Z,onChange:function(e){var t=e.target.files;t.length>0&&H(t)},style:{display:"none"},accept:".pdf",multiple:!0}))),n.a.createElement("div",{className:"actionArea"},R.length>0&&n.a.createElement(d.a,{variant:"secondary",onClick:function(){!function(){var e,t=R.flatMap((function(e){return e.items}));if((e=t.map((function(e){return Object.values(e)}))).length>0){var a=new b.a.Workbook,u=a.addWorksheet("PO");u.addRow(Object.keys(t[0])),u.addRows(e),a.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download="DO_Export.xlsx",a.click()}))}}()}},"Export to Excel")),n.a.createElement("div",{className:"itemsArea"},R.length>0&&n.a.createElement(E.a,{size:"sm",hover:!0},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("td",null,"Filename"),n.a.createElement("td",null,"DO Number"),n.a.createElement("td",null,"DO Date"),n.a.createElement("td",null,"PO Number"),n.a.createElement("td",null,"Number of items"),n.a.createElement("td",null))),n.a.createElement("tbody",null,R.map((function(e,t){return n.a.createElement("tr",{key:t},n.a.createElement("td",null,e.filename),n.a.createElement("td",null,e.doNumber),n.a.createElement("td",null,e.doDate),n.a.createElement("td",null,e.poNumber),n.a.createElement("td",null,e.items.length),n.a.createElement("td",null,n.a.createElement(p.a,{size:"sm"},n.a.createElement(d.a,{onClick:function(){u(e.data),Y(1),B(!0)}},"View PDF"),n.a.createElement(d.a,{onClick:function(){x(e.items),y(!0)}},"View Item"))))}))))),n.a.createElement(f.a,{centered:!0,scrollable:!0,show:z,onHide:function(){B(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(f.a.Header,{closeButton:!0},n.a.createElement(f.a.Title,null,"PDF Document")),n.a.createElement(f.a.Body,null,null!==a&&n.a.createElement(s.PDFReader,{data:atob(a),size:.7,onDocumentComplete:function(e){k(e)},page:N,width:W})),n.a.createElement(f.a.Footer,null,n.a.createElement("div",null,"Page ",N," of ",O),n.a.createElement(d.a,{variant:"secondary",onClick:function(){N-1>=0&&Y(N-1)},disabled:1==N},"Previous"),n.a.createElement(d.a,{variant:"secondary",onClick:function(){N+1<=O&&Y(N+1)},disabled:N==O},"Next"))),n.a.createElement(f.a,{centered:!0,scrollable:!0,show:g,onHide:function(){y(!1)},dialogClassName:"pdf-modal",size:"xl"},n.a.createElement(f.a.Header,{closeButton:!0},n.a.createElement(f.a.Title,null,"Items")),n.a.createElement(f.a.Body,null,c.length>0&&n.a.createElement("table",{className:"po-output"},n.a.createElement("thead",null,n.a.createElement("tr",null,Object.keys(c[0]).map((function(e,t){return n.a.createElement("td",{key:t},"".concat(e,"\t"))})))),n.a.createElement("tbody",null,c.map((function(e,t){return n.a.createElement("tr",{key:"item_".concat(t)},Object.keys(e).map((function(a,u){return n.a.createElement("td",{key:"item_".concat(t,"_").concat(u)},"".concat(e[a],"\t"))})))})),n.a.createElement("tr",null))))))},g=a(75),y=a(74),D=a(36),w=a(21);var O=function(e){return n.a.createElement(D.a,null,n.a.createElement(g.a,{bg:"dark",variant:"dark"},n.a.createElement(g.a.Brand,null,"PDF Extract"),n.a.createElement(y.a,{className:"mr-auto"},n.a.createElement(y.a.Link,{as:D.b,to:"po",activeStyle:{color:"white"}},"Purchase Order"),n.a.createElement(y.a.Link,{as:D.b,to:"do",activeStyle:{color:"white"}},"Delivery Order"))),n.a.createElement("div",{className:"App"},n.a.createElement(w.d,null,n.a.createElement(w.b,{path:"/po"},n.a.createElement(h,null)),n.a.createElement(w.b,{path:"/do"},n.a.createElement(v,null)),n.a.createElement(w.b,{path:"/"},n.a.createElement(w.a,{to:{pathname:"po"}})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[53,1,2]]]);
//# sourceMappingURL=main.5a277050.chunk.js.map